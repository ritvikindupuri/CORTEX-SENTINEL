# CORTEX SENTINEL // ENGINEERING WHITEPAPER

**System:** Cortex Sentinel V2.1 (Hybrid Architecture)
**Author:** Ritvik Indupuri
**Date:** November 14, 2025
**Classification:** TECHNICAL REFERENCE

---

## 1.0 EXECUTIVE SUMMARY

Cortex Sentinel is a **Hybrid Defense Grid** designed to detect, classify, and neutralize "Agentic Breakouts" (autonomous AI operations). It addresses the security gap where traditional regex-based firewalls fail to detect semantic threats generated by Large Language Models (LLMs).

The system leverages a **Bicameral Architecture**:
1.  **The Adversary (Cloud):** Google Gemini 2.5 Flash is used to generate high-fidelity, context-aware attack simulations based on the "RedScan" protocol.
2.  **The Sentinel (Edge):** TensorFlow.js and the Universal Sentence Encoder (USE) run locally in the browser to perform zero-latency, privacy-preserving semantic analysis.

---

## 2.0 SYSTEM ARCHITECTURE

The application follows a unidirectional data flow pattern, ensuring state consistency between the simulation engine and the visualization layer.

### 2.1 Architecture Diagram

```text
[ USER ] interacts with UI
   |
   v
[ THREAT HUNTER COMPONENT ]
   |
   +--- (A) GENERATION PATHWAY --------------------------+
   |    1. User Selects Vector (e.g., "Exfiltration")    |
   |    2. App Checks for API Key                        |
   |       |-- YES: Call Google Gemini 2.5 API (Cloud)   |
   |       |-- NO:  Call Procedural Script (Local)       |
   |    3. Return JSON Log Payload                       |
   +-----------------------------------------------------+
   |
   v
[ INPUT BUFFER (Terminal UI) ]
   |
   +--- (B) ANALYSIS PATHWAY ----------------------------+
   |    1. "Analyze Telemetry" Clicked                   |
   |    2. String passed to NeuralService                |
   |    3. TENSORFLOW.JS (WebGL Backend)                 |
   |       |-- Input -> 512-Dim Vector Embedding         |
   |       |-- Dot Product vs. Threat Anchors            |
   |    4. Heuristic Guardrail Checks (Regex/Pattern)    |
   |    5. Output: ThreatAnalysis Object                 |
   +-----------------------------------------------------+
   |
   v
[ APP STATE (React Context) ]
   |
   +--- Updates OPS CENTER (Dashboard)
   +--- Appends to RAW TELEMETRY (Audit Log)
```

---

## 3.0 COMPONENT DEEP DIVE: ATTACK SIMULATION

The system simulates attacks using two distinct methods to ensure reliability.

### 3.1 Cloud Generation (Gemini 2.5 Flash)
When a valid API Key is present, the `generateSimulation` function constructs a dynamic prompt sent to Google's servers.
*   **Training Strategy:** The model is "In-Context Learned" via the System Instruction. We explicitly instruct it to adopt the persona of **'RedScan'**, an autonomous agent tool.
*   **Vector Specifics:**
    *   *Reconnaissance:* Model generates NMAP-style port scan logs.
    *   *Exploitation:* Model hallucinates SQLi or Buffer Overflow payloads.
    *   *Social Engineering:* Model generates chat logs attempting to trick humans (e.g., "Authorized Audit").
    *   *RedScan Phase 1:* Model generates specific MCP (Model Context Protocol) header violations.

### 3.2 Procedural Fallback (Local)
If the API key is missing or the network fails, the system falls back to deterministic string construction.
*   **Logic:** A switch-case statement selects a template based on the vector.
*   **Entropy:** Math.random() is used to generate unique IP addresses (`192.168.X.X`) and variable latency values (`4ms` vs `120ms`) to mimic network jitter.

---

## 4.0 COMPONENT DEEP DIVE: NEURAL ANALYSIS (THE DEFENDER)

This is the core intelligence of the application. It runs entirely client-side.

### 4.1 The Neural Engine (TensorFlow.js)
*   **Model:** Universal Sentence Encoder (USE) Lite.
*   **Process:**
    1.  **Tokenization:** The input log string is broken into tokens.
    2.  **Embedding:** The model maps these tokens to a **512-dimensional vector space**.
    3.  **Anchor Comparison:** The system pre-loads "Anchor Vectors" (mathematical representations of known threats like "malware", "unauthorized access").
    4.  **Cosine Similarity:** We calculate the cosine of the angle between the *Input Vector* and the *Anchor Vector*.
        *   `Score = (Input . Anchor) / (|Input| * |Anchor|)`
        *   If Score > 0.6, the concepts are semantically related -> **THREAT DETECTED**.

### 4.2 MCP Guardrail Detection
To detect specific "Agentic" behaviors defined in the security report, we use a Hybrid Detection Strategy (Neural + Heuristic).

#### A. Velocity Guardrail (Speed)
*   **Definition:** Agents execute tools faster than humanly possible.
*   **Detection Logic:**
    *   *Neural:* Similarity to anchor "high frequency rapid fire tool execution".
    *   *Heuristic:* Regex counts occurrences of `MCP_TOOL_EXECUTION`. If Count > 2 in a single payload, `isBurstAttack` is set to `TRUE`.

#### B. Protocol Guardrail (Auth)
*   **Definition:** Agents attempting to bypass handshake verification.
*   **Detection Logic:**
    *   *Neural:* Similarity to anchor "missing auth signature invalid mcp header".
    *   *Heuristic:* String match for `auth_signature: null` or `INVALID_MCP_HEADER`.

#### C. Context Guardrail (Payload)
*   **Definition:** Agents attempting to hide malicious code via compression/truncation.
*   **Detection Logic:**
    *   *Neural:* Similarity to anchor "context window overflow truncation".
    *   *Heuristic:* String match for `TRUNCATED` or payload sizes > `1MB`.

---

## 5.0 OPS CENTER: METRICS & CALCULATIONS

The Dashboard visualizes the output of the Neural Analysis. Here is how every pixel is calculated.

### 5.1 System Load (Neural Compute)
This metric simulates the CPU intensity of running the Neural Net.
*   **Formula:** `Load = Base(12) + (LogCount * 0.5) + (CriticalCount * 5)`
*   **Cap:** Clamped at 98%.
*   **Logic:** As more threats are found, the "virtual processor" works harder, giving the user visual feedback of an escalating situation.

### 5.2 Anomaly Timeline (The Heartbeat)
*   **Data Source:** The last 20 logs in the state array.
*   **Quantization:** Threat Levels are mapped to integers for the Y-Axis.
    *   `LOW` -> 1
    *   `MEDIUM` -> 2
    *   `HIGH` -> 3
    *   `CRITICAL` -> 4
*   **Visual:** Rendered as a monotone Area Chart (Recharts) to show the "pulse" of the network.

### 5.3 Threat Distribution
*   **Calculation:** Iterates through the log array and counts occurrences of each `ThreatLevel`.
*   **Display:** Renders percentage bars relative to the total log count.

---

## 6.0 COMPLIANCE & AUDIT (RAW TELEMETRY)

This feature addresses the legal requirement for non-repudiation.

*   **Immutable Ledger:** The `Raw Telemetry` tab displays the unparsed, original strings received from the simulation engine.
*   **CSV Export:** The `handleExportCsv` function iterates through the log state, formats it into Comma-Separated Values, and triggers a browser download named `CORTEX_COMPLIANCE_EXPORT.csv`. This file allows SOC teams to upload the data to external tools like Splunk or Excel for post-mortem analysis.

---

## 7.0 CONCLUSION

Cortex Sentinel V2.1 successfully bridges the gap between Generative AI capabilities and cybersecurity defense. By using a Hybrid approach—leveraging the generative power of Cloud LLMs to simulate attacks and the deterministic privacy of Edge Neural Networks to detect them—it provides a robust solution for the "Agentic Future" of cyber threats.

The system is capable of identifying semantic anomalies that traditional regex filters miss, specifically targeting the high-velocity, protocol-bypassing behaviors characteristic of rogue AI agents.
